# Детский анализ рисунков

Этот проект представляет собой Telegram мини-приложение, созданное для анализа детских рисунков с целью оценки психологического состояния и развития ребенка. Приложение обрабатывает загруженные изображения, генерирует подробный отчет и поддерживает различные функции, включая:

- **Режим polling**: Бот работает в polling режиме, что позволяет ему реагировать на сообщения в режиме реального времени.
- **Поддержка групп**: Бот может быть добавлен в группы Telegram с обработкой команд и сообщений.
- **Анализ изображений**: Используется базовая логика анализа изображений для определения параметров, таких как психологический возраст, уровень воображения, эмоциональный интеллект и физическое состояние.
- **Генерация отчета**: На основе анализа рисунка генерируется подробный отчёт с рекомендациями.
- **Платежная система**: Реализована логика для обработки платежей с несколькими тарифными планами.
- **Двуязычный интерфейс**: Интерфейс бота поддерживает переключение между русским и английским языками.
- **Логирование и отладка**: В проекте реализована базовая настройка логирования для отладки, которую можно отключать в production.

## Структура проекта

```
ChildrensDrawings/
├── Procfile                  // Файл для Railway, указание команды для запуска бота
├── railway.json              // Конфигурационный файл для Railway deployment
├── requirements.txt          // Список зависимостей
├── main.py                   // Главный файл для запуска бота
├── README.md                 // Документация проекта (этот файл)
├── config.py                 // Настройки проекта (токен, база данных и т.д.)
├── logging_config.py         // Настройка логирования
├── telegram_bot/
│   ├── __init__.py
│   ├── handlers.py           // Обработчики команд и сообщений
│   ├── bot.py                // Конфигурация бота и запуск polling
│   ├── utils.py              // Утилиты и вспомогательные функции
│   └── payments.py           // Логика обработки платежей и тарифов
└── image_processing/
    ├── __init__.py
    ├── analyzer.py           // Функции анализа изображений
    ├── models.py             // Заглушка модели анализа рисунков
    └── report_generator.py   // Генерация отчётов на основе анализа
```

## Установка и запуск

1. Клонируйте репозиторий на локальную машину.
2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Настройте токен бота:
   - Создайте бота через [@BotFather](https://t.me/BotFather) в Telegram и получите токен
   - Установите токен одним из способов:
     - Через переменную окружения: `export BOT_TOKEN=ваш_токен_бота`
     - Или отредактируйте файл `config.py`, заменив 'YOUR_BOT_TOKEN' на ваш токен

4. Запустите бота:

   ```bash
   python main.py
   ```

## Развертывание на Railway.app

Для развертывания проекта на Railway.app:

1. Создайте проект на Railway.app
2. Подключите ваш репозиторий GitHub
3. Добавьте переменную окружения `BOT_TOKEN` с вашим токеном Telegram бота в настройках проекта
4. Деплой произойдет автоматически с использованием указанных настроек в `railway.json` и `Dockerfile`

## Поддержка OpenAI Streaming

Проект поддерживает режим стриминга ответа от OpenAI, что позволяет получать обновления по мере генерации ответа.

## Замечания

- Все функции анализа и обработки изображений являются заглушками и могут быть расширены для полноценного использования.
- Логирование и отладка включены для упрощения диагностики, но в production рекомендуется отключать подробное логирование.

## Дополнительные ресурсы

- [Документация по python-telegram-bot](https://python-telegram-bot.org/)
- [Документация по FastAPI](https://fastapi.tiangolo.com/)
- [Техническая документация Railway.app](https://railway.app/) 